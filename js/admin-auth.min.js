const AUTH_CONFIG={username:"admin",password:"kaefadaboe"},RATE_LIMIT={maxAttempts:5,lockoutDuration:9e5,attemptWindow:3e5};function isAuthenticated(){return"true"===localStorage.getItem("adminAuth")}function checkRateLimit(){const t=JSON.parse(localStorage.getItem("loginAttempts")||"[]"),e=Date.now(),o=t.filter(t=>e-t<RATE_LIMIT.attemptWindow),n=localStorage.getItem("lockoutUntil");if(n&&e<parseInt(n)){return{allowed:!1,message:`Too many failed attempts. Try again in ${Math.ceil((parseInt(n)-e)/6e4)} minute(s).`}}if(o.length>=RATE_LIMIT.maxAttempts){const t=e+RATE_LIMIT.lockoutDuration;return localStorage.setItem("lockoutUntil",t.toString()),{allowed:!1,message:"Too many failed attempts. Account locked for 15 minutes."}}return{allowed:!0}}function recordFailedAttempt(){const t=JSON.parse(localStorage.getItem("loginAttempts")||"[]");t.push(Date.now()),localStorage.setItem("loginAttempts",JSON.stringify(t))}function clearLoginAttempts(){localStorage.removeItem("loginAttempts"),localStorage.removeItem("lockoutUntil")}function login(t,e){const o=checkRateLimit();return o.allowed?t===AUTH_CONFIG.username&&e===AUTH_CONFIG.password?(localStorage.setItem("adminAuth","true"),clearLoginAttempts(),{success:!0}):(recordFailedAttempt(),{success:!1,message:"Invalid username or password"}):{success:!1,message:o.message}}function logout(){localStorage.removeItem("adminAuth"),window.location.href="admin.html"}const isDashboard=window.location.pathname.includes("admin-dashboard.html");isDashboard&&!isAuthenticated()&&(window.location.href="admin.html"),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("login-form");t&&t.addEventListener("submit",function(t){t.preventDefault();const e=document.getElementById("username").value,o=document.getElementById("password").value,n=document.getElementById("login-message"),a=login(e,o);a.success?(n.textContent="Login successful! Redirecting...",n.className="form-message success",n.style.display="block",setTimeout(function(){window.location.href="admin-dashboard.html?login=success"},500)):(n.textContent=a.message,n.className="form-message error",n.style.display="block")});const e=document.getElementById("logout-btn");e&&e.addEventListener("click",logout)});