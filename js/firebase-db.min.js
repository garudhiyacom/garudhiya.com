async function saveBlogPostToFirebase(t){try{if(t.id)await db.collection("blogPosts").doc(t.id.toString()).set(t);else{const e=await db.collection("blogPosts").add(t);t.id=e.id}return console.log("✅ Blog post saved to Firebase"),t}catch(t){throw console.error("❌ Error saving blog post:",t),t}}async function getBlogPostsFromFirebase(){try{const t=await db.collection("blogPosts").get(),e=[];return t.forEach(t=>{e.push({id:t.id,...t.data()})}),e.sort((t,e)=>new Date(e.date)-new Date(t.date)),e}catch(t){return console.error("❌ Error getting blog posts:",t),[]}}async function deleteBlogPostFromFirebase(t){try{await db.collection("blogPosts").doc(t.toString()).delete(),console.log("✅ Blog post deleted from Firebase")}catch(t){throw console.error("❌ Error deleting blog post:",t),t}}async function saveProductToFirebase(t){try{if(t.id)await db.collection("products").doc(t.id.toString()).set(t);else{const e=await db.collection("products").add(t);t.id=e.id}return console.log("✅ Product saved to Firebase"),t}catch(t){throw console.error("❌ Error saving product:",t),t}}async function getProductsFromFirebase(){try{const t=await db.collection("products").get(),e=[];return t.forEach(t=>{e.push({id:t.id,...t.data()})}),e}catch(t){return console.error("❌ Error getting products:",t),[]}}async function deleteProductFromFirebase(t){try{await db.collection("products").doc(t.toString()).delete(),console.log("✅ Product deleted from Firebase")}catch(t){throw console.error("❌ Error deleting product:",t),t}}async function saveCommentToFirebase(t){try{if(t.id)await db.collection("comments").doc(t.id).set(t),console.log("✅ Comment updated in Firebase");else{const e=await db.collection("comments").add(t);t.id=e.id,console.log("✅ Comment saved to Firebase")}return t}catch(t){throw console.error("❌ Error saving comment:",t),t}}async function getCommentsFromFirebase(t){try{const e=await db.collection("comments").where("postId","==",t).get(),o=[];return e.forEach(t=>{o.push({id:t.id,...t.data()})}),o.sort((t,e)=>(e.timestamp||0)-(t.timestamp||0)),o}catch(t){return console.error("❌ Error getting comments:",t),[]}}async function getAllCommentsFromFirebase(){try{const t=await db.collection("comments").get(),e=[];return t.forEach(t=>{e.push({id:t.id,...t.data()})}),e.sort((t,e)=>(e.timestamp||0)-(t.timestamp||0)),e}catch(t){return console.error("❌ Error getting all comments:",t),[]}}async function deleteCommentFromFirebase(t){try{const e=await db.collection("comments").where("parentId","==",t).get(),o=[t];e.forEach(t=>{o.push(t.id)});const r=db.batch();e.forEach(t=>{r.delete(t.ref)});const s=db.collection("comments").doc(t);r.delete(s),await r.commit(),console.log(`✅ Comment and ${e.size} replies deleted from Firebase`),cleanupUserInteractions(o).catch(t=>{console.warn("⚠️ Error cleaning up user interactions:",t)})}catch(t){throw console.error("❌ Error deleting comment:",t),t}}async function cleanupUserInteractions(t){try{const e=await db.collection("userInteractions").get();if(e.empty)return;const o=db.batch();let r=0;e.forEach(e=>{const s=e.data();let c=!1;const n=s.likes||{},a=s.dislikes||{};t.forEach(t=>{n[t]&&(delete n[t],c=!0),a[t]&&(delete a[t],c=!0)}),c&&(o.update(e.ref,{likes:n,dislikes:a}),r++)}),r>0&&(await o.commit(),console.log(`✅ Cleaned up ${r} user interaction documents`))}catch(t){throw console.error("❌ Error cleaning up user interactions:",t),t}}async function updatePostStats(t,e=0,o=0){try{const r=db.collection("postStats").doc(t.toString()),s=await r.get();if(s.exists){const t=s.data();await r.update({views:t.views+e,likes:t.likes+o})}else await r.set({views:e,likes:o})}catch(t){console.error("❌ Error updating post stats:",t)}}async function getPostStats(t){try{const e=await db.collection("postStats").doc(t.toString()).get();return e.exists?e.data():{views:0,likes:0}}catch(t){return console.error("❌ Error getting post stats:",t),{views:0,likes:0}}}async function getPostStatsFromFirebase(t){return await getPostStats(t)}async function incrementPostViewsInFirebase(t){try{const e=await getPostStats(t);await updatePostStats(t,(e.views||0)+1,e.likes||0),console.log("✅ Post views incremented")}catch(t){throw console.error("❌ Error incrementing views:",t),t}}async function incrementPostLikesInFirebase(t,e=1){try{const o=await getPostStats(t),r=Math.max(0,(o.likes||0)+e);await updatePostStats(t,o.views||0,r),console.log("✅ Post likes updated")}catch(t){throw console.error("❌ Error updating likes:",t),t}}